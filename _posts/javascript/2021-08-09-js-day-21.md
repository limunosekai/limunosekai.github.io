---
layout: post
title: RxJS Operator (ê³„ì† ì—…ë°ì´íŠ¸)
category: Javascript
permalink: /javascript/:year/:month/:day/:title/
tags: [Javascript]
comments: true
---

---

## [RxJS] Operator (ê³„ì† ì—…ë°ì´íŠ¸)

---

### 1. Operator

ì—°ì‚°ìëŠ” í•¨ìˆ˜ì´ë‹¤. ì—°ì‚°ìì—ëŠ” 2ì¢…ë¥˜ê°€ ìˆë‹¤.

- **íŒŒì´í”„í˜• ì—°ì‚°ì** : pipe(operator()) êµ¬ë¬¸ì„ ì‚¬ìš©í•´ì„œ inputì— ëŒ€í•œ ê°™ì€ outputë§Œì„ ë°˜í™˜í•˜ëŠ” ìˆœìˆ˜ì—°ì‚°ì„ í•œë‹¤. ë”°ë¼ì„œ, íŒŒì´í”„í˜• ì—°ì‚°ìëŠ” ìˆœìˆ˜í•¨ìˆ˜ì´ê³  Observable ê°ì²´ë¥¼ ë°›ì•„ ë‹¤ë¥¸ Observableì„ ë°˜í™˜í•œë‹¤.

  **pipe()** : íŒŒì´í”„ ì—°ì‚°ìëŠ” RxJS 5.5 ì´ì „ì— ì‚¬ìš©ë˜ë˜ chainingì„ ê°€ë…ì„± ì¢‹ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

  ```javascript
  // Before RxJS 5.5
  Observable.operator1().operator2().operator3().subscribe(...);

  // Since RxJS 5.5
  Observable.pipe(
  	operator1(),
      operator2(),
      operator3()
  ).subscribe(...);
  ```

  <br>

- **ìƒì„± ì—°ì‚°ì** : ìƒˆë¡œìš´ Observable ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ ë‹¨ë… í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œë  ìˆ˜ ìˆë‹¤.

<br>

### 2. Higher-order Observables (ê³ ì°¨ Observables)

Observableì€ ë³´í¸ì ìœ¼ë¡œ string, number ê°™ì€ ë³´í†µì˜ ê°’ì„ ë‚´ë³´ë‚´ì§€ë§Œ, observableì„ ë‹¤ë£¨ëŠ” observableì„ ê³ ì°¨ Observableì´ë¼ê³  í•œë‹¤.

ê³ ì°¨ Observableì€ ì¼ë°˜ì ìœ¼ë¡œ í‰íƒ„í™”í•´ì„œ ì‚¬ìš©í•˜ëŠ”ë° ê³ ì°¨ Observableì„ í•˜ë‚˜ì˜ ë³´í†µ Observableë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•œë‹¤.

concatAll(), mergeAll(), switchAll(), exhaust(), concatMap(), mergeMap(), switchMap(), exhaustMap() ë“± ì‚¬ìš©.

<br>

### 3. Marble Diagram (ë§ˆë¸” ë‹¤ì´ì–´ê·¸ë¨)

Observableì˜ ì—°ì‚°ìë¥¼ ì„¤ëª…í•  ë•Œ ì‹œê°„ì˜ íë¦„ì— ë”°ë¼ ì–´ë–»ê²Œ ì‘ë™í•˜ëŠ”ì§€ ê·¸ë¦¼ì„ í†µí•´ ì‹œê°ì ìœ¼ë¡œ ì œê³µí•œë‹¤.

> Marble Diagram : https://rxmarbles.com/

<br>

### 4. Custom Operator

pipe() í•¨ìˆ˜ë¡œ ìƒˆë¡œìš´ ì—°ì‚°ìë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. í”íˆ ì‚¬ìš©ë˜ëŠ” ì—°ì‚°ìë“¤ì˜ ì‹œí€€ìŠ¤ë¥¼ í•˜ë‚˜ë¡œ ë¬¶ì„ ìˆ˜ ìˆë‹¤.

```javascript
import { pipe } from "rxjs";
import { filter, map } from "rxjs/operators";

function discardOddDoubleEven() {
  return pipe(
    filter((v) => !(v % 2)),
    map((v) => v + v)
  );
}
// í™€ìˆ˜ë¥¼ ë²„ë¦¬ê³  ì§ìˆ˜ë¥¼ 2ë°°í•˜ëŠ” Custom Operator
```

<u>pipe() í•¨ìˆ˜ëŠ” Observableì˜ pipe() ë©”ì†Œë“œì™€ ìœ ì‚¬í•˜ì§€ë§Œ ê°™ì§€ ì•Šë‹¤.</u>

<br>

### 5. ìì£¼ ì‚¬ìš©ë˜ëŠ” ì—°ì‚°ì ì •ë¦¬

#### ğŸ‘» Creation Operators

**of()** : ë‚˜ì—´ëœ ì¸ìë¥¼ ìˆœì„œëŒ€ë¡œ nextí•˜ëŠ” Observable ë°˜í™˜

```javascript
import { of } from "rxjs";

of(1, 2, 3).subscribe(
  (next) => console.log("next: ", next),
  (err) => console.log("err: ", err),
  () => console.log("complete")
);
// next: 1, next: 2, next: 3, complete

// ë°°ì—´ì„ ì „ë‹¬í•˜ë©´ ë°°ì—´ì´ í†µìœ¼ë¡œ ë‚˜ì˜´
of([1, 2, 3]).subscribe(
  (next) => console.log("next: ", next),
  (err) => console.log("err: ", err),
  () => console.log("complete")
);
// next: [1,2,3], complete
```

<br>

**from()** : array, observable, Promise, string, array-like, iterable ë“±ì„ Observableë¡œ ë°˜í™˜

```javascript
import { from } from "rxjs";

const arr = [1, 2, 3];
const result = from(arr);
result.subscribe((x) => console.log(x));
// 1, 2, 3
```

<br>

**fromEvent()** : ë¸Œë¼ìš°ì €ì—ì„œ ë°œìƒí•˜ëŠ” Eventë¥¼ Observableë¡œ ë°˜í™˜

```javascript
import { fromEvent } from "rxjs";

const clicks = fromEvent(document, "click");
clicks.subscribe((x) => console.log(x));
// MouseEvent Object
```

<br>

**defer()** : íŒ©í† ë¦¬ í•¨ìˆ˜ë¡œ Observable ìƒì„± í›„ êµ¬ë… ì‹œì ì— íŒ©í† ë¦¬ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•´ ë§Œë“¤ì–´ë‘” Observable ë°˜í™˜ë°›ì•„ êµ¬ë…í•œë‹¤. fromì€ Promise ìƒì„± í›„ ë°”ë¡œ ë™ì‘ì‹œí‚¤ì§€ë§Œ deferëŠ” Observableì„ subscribeí•˜ëŠ” ì‹œì ì— Promiseë¥¼ ìƒì„±í•  ìˆ˜ ìˆì–´ì„œ ë™ì‘ ì‹œì ì„ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.

```javascript
import { defer, fromEvent, interval } from "rxjs";

const clickOrInterval = defer(() => {
  return Math.random() > 0.5 ? fromEvent(document, "click") : interval(1000);
});
clickOrInterval.subscribe((x) => console.log(x));

// ëœë¤ ìˆ«ìê°€ 0.5ë³´ë‹¤ í¬ë©´ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ëŒ€ê¸°í•œë‹¤.
// ëœë¤ ìˆ«ìê°€ 0.5ë³´ë‹¤ ì‘ìœ¼ë©´ 1ì´ˆë§ˆë‹¤ ë°©ì¶œí•œë‹¤.
```

<br>

**range()** : ë²”ìœ„ ë‚´ ìˆ«ìë“¤ì„ ê°–ëŠ” Observable ìƒì„±

```javascript
import { range } from "rxjs";

const numbers = range(1, 10);
numbers.subscribe((x) => console.log(x));
// 1ë¶€í„° 10ê¹Œì§€ ì¶œë ¥
```

<br>

**interval()** : setInterval()ê³¼ ìœ ì‚¬í•˜ë©° ì¼ì • ê°„ê²©ë§ˆë‹¤ ê°’ì„ ë°œí–‰í•˜ëŠ”ë° 0ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ ì¦ê°€, ëª…ì‹œì ìœ¼ë¡œ êµ¬ë…í•´ì œ í•˜ì§€ ì•Šìœ¼ë©´ ë¬´í•œí•˜ê²Œ ê°’ì„ ë°œí–‰í•˜ë‹ˆ ì£¼ì˜í•  ê²ƒ.

```javascript
import { interval } from "rxjs";

const intervalObservable = interval(1000).subscribe(
  (v) => console.log("next: ", v),
  (err) => console.log("err: ", err),
  () => console.log("complete")
);

setTimeout(() => {
  intervalObservable.unsubscribe();
}, 3000);

// next: 1, next: 2, next: 3, complete
```

<br>

**timer()** : setTimeout()ê³¼ ìœ ì‚¬í•˜ë©° íŠ¹ì • ì‹œê°„ ì´í›„ ê°’ì„ ë°œí–‰í•œë‹¤.

```javascript
import { timer } from "rxjs";

const numbers = timer(3000, 1000); // 3ì´ˆ í›„ì— ì‹œì‘í•˜ë©° 1ì´ˆë§ˆë‹¤ ë°œí–‰
numbers.subscribe((x) => console.log(x));

setTimeout(() => {
  numbers.unsubscribe();
}, 6000);

// 0, 1, 2
```

<br>

**empty(), never(), throwError()** : empty()ëŠ” Observable complete ìƒíƒœë¥¼ ì „ë‹¬í•˜ëŠ” Observable ìƒì„±, never()ëŠ” ì–´ë–¤ê°’ë„ ë°œí–‰í•˜ì§€ ì•ŠëŠ” Observable, throwError()ëŠ” í˜¸ì¶œ ì¦‰ì‹œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¨ë‹¤. empty()ì™€ never()ëŠ” RxJS 6 ì´í›„ deprecatedë˜ì—ˆìœ¼ë©° ìƒìˆ˜ë¡œ ë³€ê²½ë˜ì—ˆë‹¤.

```javascript
import { EMPTY } from "rxjs";

EMPTY.subscribe(
  () => console.log("next"),
  (err) => console.log("err"),
  () => console.log("complete")
);
// complete

import { NEVER } from "rxjs";

NEVER.subscribe(
  () => console.log("next"),
  (err) => console.log("err"),
  () => console.log("complete")
);
// ì•„ë¬´ê²ƒë„ ì¶œë ¥ë˜ì§€ ì•ŠìŒ

import { throwError } from "rxjs";

throwError("err!").subscribe(
  () => console.log("next"),
  (err) => console.log("err: ", err),
  () => console.log("complete")
);
// err: err!
```

<br>

#### ğŸ‘» Transformation Operators

**map()** : array methodì˜ mapê³¼ ìœ ì‚¬í•˜ë©° Observableì„ ë‹¤ë¥¸ Observableë¡œ ë³€í™˜í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.

```javascript
const observable = of(1, 2, 3, 4, 5);

const subscription = observable
  .pipe(map((val) => val * val))
  .subscribe((val) => console.log(val));
// 1, 4, 9, 16, 25
```

<br>

**mapTo() :** Observableì´ ê°’ì„ ë°©ì¶œí•  ë•Œë§ˆë‹¤ ì£¼ì–´ì§„ ìƒìˆ˜ ê°’ì„ ë°©ì¶œí•œë‹¤.

```javascript
import { fromEvent } from "rxjs";
import { mapTo } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const greetings = clicks.pipe(mapTo("Foo"));
greetings.subscribe((x) => console.log(x));

// clickì‹œë§ˆë‹¤ 'Foo' ì¶œë ¥
```

<br>

**mergeMap() :** Observableì´ ë°©ì¶œí•˜ëŠ” ê°’ì„ ì¶œë ¥ Observableê³¼ í•¨ê»˜ ë³‘í•©í•œë‹¤.

```javascript
import { of, interval } from "rxjs";
import { mergeMap, map } from "rxjs/operators";

const letters = of("a", "b");
const result = letters.pipe(
  mergeMap((x) => interval(1000).pipe(map((i) => x + i)))
);
result.subscribe((x) => console.log(x));

// a0, b0, a1, b1, a2, b2 ...
```

<br>

**switchMap() :** mergeMapê³¼ ë¹„ìŠ·í•˜ì§€ë§Œ, ì™¸ë¶€ Observableì´ ë°œìƒë  ë•Œë§ˆë‹¤ ë‚´ë¶€ Observableì˜ ìƒˆë¡œìš´ êµ¬ë…ì´ ì‹œì‘ëœë‹¤.

```javascript
import { fromEvent, interval } from "rxjs";
import { switchMap } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const result = clicks.pipe(switchMap((ev) => interval(1000)));
result.subscribe((x) => console.log(x));

// click, 0, 1, 2, click, 0, 1, click, 0 ...
// í´ë¦­í•  ë•Œë§ˆë‹¤ êµ¬ë…ì´ ì·¨ì†Œë˜ê³  ìƒˆë¡œìš´ êµ¬ë…ì´ ì‹œì‘ë¨
```

<br>

#### ğŸ‘» Filtering Operators

**debounceTime() :** ì¶œë ¥ ì‚¬ì´ì˜ ì§€ì •ëœ ì‹œê°„ì´ ê²½ê³¼í•˜ì§€ ì•Šìœ¼ë©´ ì´ ì‹œê°„ ë‚´ì˜ ë°©ì¶œëœ ê°’ë“¤ì„ ë²„ë¦°ë‹¤.

```javascript
import { fromEvent } from "rxjs";
import { debounceTime } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const result = clicks.pipe(debounceTime(3000));
result.subscribe((x) => console.log(x));

// ë§ˆì§€ë§‰ í´ë¦­ í›„ 3ì´ˆ í›„ì— click object ì¶œë ¥
```

<br>

**throttleTime() :** ì§€ì •ëœ ì‹œê°„ë™ì•ˆ ì²˜ìŒ ê°’ì„ ì œì™¸í•œ ê°’ë“¤ì„ ë²„ë¦°ë‹¤.

```javascript
import { fromEvent } from "rxjs";
import { throttleTime } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const result = clicks.pipe(throttleTime(3000));
result.subscribe((x) => console.log(x));

// í´ë¦­ ì—°íƒ€ ì‹œ ì²˜ìŒ click Object ì¶œë ¥ í›„ 3ì´ˆ í›„ì— click Object ì¶œë ¥
```

<br>
**take()** : take(number)ì˜ numberì— ì „ë‹¬ëœ ê°’ê³¼ ê°™ì€ ê°œìˆ˜ì˜ ê°’ë“¤ë§Œ ë°©ì¶œí•œë‹¤.

**filter()** : array methodì˜ filterì™€ ìœ ì‚¬í•˜ë©° Observableì˜ í•„í„°ë§ì— ì‚¬ìš©ëœë‹¤

```javascript
const observable = of(1, 2, 3, 4, 5);

const subscription = observable
  .pipe(filter((val) => val % 2 === 0))
  .subscribe((val) => console.log(val));
// 2, 4
```

<br>

#### ğŸ‘» Join Operators

**startWith() :** ì¶œë ¥ Observableì´ ë°©ì¶œë˜ê¸° ì „ì— startWithì˜ ì†ŒìŠ¤ë“¤ì´ ë¨¼ì € ë°©ì¶œëœë‹¤.

```javascript
import { of } from "rxjs";
import { startWith } from "rxjs/operators";

of("a", "b")
  .pipe(startWith("first", "second"))
  .subscribe((x) => console.log(x));

//  'first', 'second', 'a', 'b'
```

<br>

**withLatestFrom() :** ë‘ ê°œì˜ Observableì„ í•©ì„±í•˜ì§€ë§Œ, í•œìª½ì—ì„œ ì´ë²¤íŠ¸ê°€ ë°œìƒí•  ë•Œì—ë§Œ í•©ì„±í•´ì¤€ë‹¤.
ì´ë²¤íŠ¸ ë°œìƒì´ ì—†ë‹¤ë©´ ìŠ¤í‚µëœë‹¤.

```javascript
import { fromEvent, interval } from "rxjs";
import { withLatestFrom } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const timer = interval(1000);
const result = clicks.pipe(withLatestFrom(timer));
result.subscribe((x) => console.log(x));

// clickì´ ë°œìƒí• ë•Œë§Œ [click Object, ê²½ê³¼í•œ ì‹œê°„]ì´ ì¶œë ¥ëœë‹¤.
```

<br>

#### ğŸ‘» Error Handling Operators

**catchError() :** ì˜¤ë¥˜ ë°œìƒ ì‹œ ìƒˆ Observableì„ ë°˜í™˜í•˜ê±°ë‚˜ ì˜¤ë¥˜ë¥¼ ë°˜í™˜í•˜ê±°ë‚˜ retry í•  ìˆ˜ ìˆë‹¤.

```javascript
import { of } from "rxjs";
import { map, catchError } from "rxjs/operators";

of(1, 2, 3, 4, 5)
  .pipe(
    map((n) => {
      if (n === 4) {
        throw "four!";
      }
      return n;
    }),
    catchError((err) => of("I", "II", "III", "IV", "V"))
  )
  .subscribe((x) => console.log(x));
// ì˜¤ë¥˜ ë°œìƒ ì‹œ ë‹¤ë¥¸ Observable ë°©ì¶œ
// 1, 2, 3, I, II, III, IV, V

import { of } from "rxjs";
import { map, catchError, take } from "rxjs/operators";

of(1, 2, 3, 4, 5)
  .pipe(
    map((n) => {
      if (n === 4) {
        throw "four!";
      }
      return n;
    }),
    catchError((err, caught) => caught),
    take(30)
  )
  .subscribe((x) => console.log(x));
// ì˜¤ë¥˜ ë°œìƒ ì‹œ retryí•œë‹¤
// 1, 2, 3, 1, 2, 3, ...

import { of } from "rxjs";
import { map, catchError } from "rxjs/operators";

of(1, 2, 3, 4, 5)
  .pipe(
    map((n) => {
      if (n === 4) {
        throw "four!";
      }
      return n;
    }),
    catchError((err) => {
      throw "error in source. Details: " + err;
    })
  )
  .subscribe(
    (x) => console.log(x),
    (err) => console.log(err)
  );
// ì˜¤ë¥˜ ë°œìƒ ì‹œ new errorë¥¼ ë°œìƒì‹œí‚¨ë‹¤.
// 1, 2, 3, error in source. Details: four!
```

<br>

#### ğŸ‘» Utility Operators

**tap() :** ì†ŒìŠ¤ì—ì„œ ê° ë°©ì¶œì„ ê°€ë¡œì±„ì„œ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” í•œ ì†ŒìŠ¤ì™€ ë™ì¼í•œ ì¶œë ¥ì„ ë°˜í™˜

```javascript
import { fromEvent } from "rxjs";
import { tap, map } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const positions = clicks.pipe(
  tap((ev) => console.log(ev)),
  map((ev) => ev.clientX)
);
positions.subscribe((x) => console.log(x));
```

<br>

**delay() :** ì£¼ì–´ì§„ ì‹œê°„ê¹Œì§€ Observable ë°©ì¶œì„ ì§€ì—°ì‹œí‚¨ë‹¤.

```javascript
import { fromEvent } from "rxjs";
import { delay } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const delayedClicks = clicks.pipe(delay(1000)); // 1ì´ˆì”© ì§€ì—°ë˜ì–´ ë°©ì¶œ
delayedClicks.subscribe((x) => console.log(x));

// ---------------------------------------------------------------

import { fromEvent } from "rxjs";
import { delay } from "rxjs/operators";

const clicks = fromEvent(document, "click");
const date = new Date("March 15, 2050 12:00:00");
const delayedClicks = clicks.pipe(delay(date)); // í•´ë‹¹ ë‚ ì§œ í›„ì— ë°©ì¶œ ê°€ëŠ¥
delayedClicks.subscribe((x) => console.log(x));
```

<br>

---

## ì°¸ê³  ìë£Œ

---

[ReactiveX ê³µì‹ë¬¸ì„œ](http://reactivex.io/)

[RxJS ê³µì‹ë¬¸ì„œ](https://rxjs.dev/)

[[Javascript] RxJS - Operators](https://steadev.tistory.com/59)
